<%= simple_form_for [@building, @expense]  do |f| %>
  <% unless action_name == "new" || action_name == "create" %>
    <%= f.input :number, label: "Comp. Egreso Num" %>
  <% end %>
  <%= f.input :beneficiary, label: "Beneficiario", value: "Miguel Ferrer"%>
  <%= f.input :payment_method, label: "MÃ©todo de pago", collection: Expense.payment_methods.keys%>
  <%= f.input :date, as: :string, input_html: { class: "datepicker-expense" }, label: "Fecha del egreso"%>
  <%= f.input :description, label: "DescripciÃ³n"%>
  <%= f.input :amount, label: "Monto", input_html: { class: "amount-input" }%>
  <%= f.input :observation, label: "Observaciones"%>
  <%= f.simple_fields_for :attachments, Attachment.new do |p| %>
      <%= p.input :file, label: "Achivos Adjuntos", as: :file, input_html: { multiple: true,  name: "expense[attachments_attributes][][file]"} %>
  <% end %>
  <% f.object.attachments.each_with_index do |attachment, index| %>
      <% if attachment.id %>
        <% attachments_delete_params = {
            expense: {
              building_id: @building.id,
              attachments_attributes: {
                id: attachment.id,
                _destroy: true
              }
            },
          }
        %>
        <ul class="attachments-list">
          <li>
            <%= index + 1 %>. <%= attachment.name %>
            <%= link_to building_expense_path(f.object.id, attachments_delete_params), class: "delete-attachement", method: :patch, data: { confirm: 'Are you sure?' } do%>
              Eliminar
              <i class="material-icons"> delete </i>
            <% end %>
          </li>
        </ul>
      <% end %>
    <% end %>
  <%#= f.file_field :attachments, multiple: true %>
  <%#= f.hidden_field :attachments_cache %>
  <%= f.input :building_id, as: :hidden, input_html: { value: @building.id } %>
  <span class="new-property-form-btns">
    <%= link_to "cancelar", building_expenses_path, class:"form-btn--no-background" %>
    <% if action_name == "new" || action_name == "create" %>
      <%= f.submit "Crear", class:"btn form-btn" %>
    <% else %>
      <%= f.submit "Editar", class:"btn form-btn" %>
    <% end %>
  </span>
<% end %>
