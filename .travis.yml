language: ruby
cache:
  bundler: true
  yarn: true
services:
- redis-server
sudo: required
before_install:
- sudo apt-get update
- sudo apt-get install google-chrome-stable
addons:
  postgresql: '9.6'
before_script:
- psql -c 'create database product_hunt_clone_test;' -U postgres
script:
- bundle exec rake db:create
- bundle exec rake db:migrate RAILS_ENV=test
- bundle exec rake db:schema:load
- bundle exec rake db:test:prepare
- SECRET_KEY_BASE=a RAILS_ENV=production bundle exec rake assets:precompile
- bundle exec rspec
env:
  global:
    secure: Evyk3Q3Kiv4O7lfA5vlBP3ptidkBtmMJmktXEQrbF43UbBI8D8w4TY8bKapCTG/GuO28EyP8fAxWzNITdteIAX1UqsxwiO001/zK9nHyuZVpCEPePnsRJLkhlmD9MJ/EN3ksBd4dUG7KlkiZlAofd9guEMPiPTA67GMhb8oHipeeLA+q2HZ3nmv7GXpmtGC6mVwXPGK3qMYFBqT/Lb6FY4Lk9L25CYykmiZeieZnvEaa0av88olXMhlXGcsXeLtKOYf3FzfDVYdAaM5UQct3puyAo6BXsEWggxdC46UVKAVQtqdbMFl7ZEq0Ml5c8GzJ7/5lk2cjm7diHucWDA96JuI5Gy0XQdfxZOSW6rYO4R6iuU4e8ezgZajdK+CsMhGX7gJhR2qQDQYZA5W5fcoA9yI7vx3Pg+y4GfN+M2/aBSKAX81fMQWO5AWXnSHnQuG23VifCZQKmyGIPpwHg/ht9hMoGV1kAsSU5sbrn8tBFkHHcuu6O0hwLJGf72NrSPe4zZ3M7NyHPHf9aeQS8wpQ06B7qD7NZ2BOBbwptQmHlu6uJCYr015kUiEXQL1qqdLr8SnLjM1QWq+f2BuUG+CCX3r4KmhWwcCJXJC/qpUhZBrn9jPgg5hUh7yUdTjUsToLUwWsDSJMXqPh4eTHc7qa4NU61FDhpwGN+5pT8Mk4fs0=
